# Exodus 17
```
function exodus_17_waterAndBattle() {
  // === 17:1-7 - Water from the Rock ===
  israelites.journey({
    context: {
      location: "Wilderness_of_Sin_to_Rephidim",
      movement: "by_stages_as_Lord_commanded"
    },
    crisis: {
      issue: "no_water_for_people_to_drink",
      complaint: {
        audience: "Moses",
        accusation: [
          "why_did_you_bring_us_up_out_of_Egypt",
          "to_kill_us_and_our_children_and_livestock_with_thirst"
        ]
      }
    }
  });

  moses.cryToLord({
    plea: "what_shall_I_do_with_this_people",
    urgency: "they_are_almost_ready_to_stone_me"
  });

  lord.instructMoses({
    command: [
      "pass_on_before_the_people",
      "take_with_you_some_elders_of_Israel",
      "take_in_your_hand_staff_with_which_you_struck_Nile"
    ],
    action: {
      location: "rock_at_Horeb",
      instruction: [
        "I_will_stand_before_you_there_on_rock",
        "strike_the_rock_and_water_shall_come_out_of_it",
        "people_may_drink"
      ]
    }
  });

  moses.execute({
    action: "struck_rock_in_sight_of_elders",
    outcome: "water_came_out",
    naming: [
      "called_place_Massah_and_Meribah",
      "because_of_quarreling_of_Israelites",
      "because_they_tested_Lord_saying_is_Lord_among_us_or_not"
    ]
  });

  // === 17:8-16 - Battle with Amalek ===
  amalek.attack({
    context: {
      location: "Rephidim",
      action: "came_and_fought_with_Israel"
    }
  });

  moses.commandJoshua({
    instruction: [
      "choose_men_for_us",
      "go_out_and_fight_with_Amalek"
    ],
    plan: [
      "tomorrow_I_will_stand_on_top_of_hill",
      "with_staff_of_God_in_my_hand"
    ]
  });

  battle.execute({
    preparation: "Joshua_did_as_Moses_told_him_and_fought_with_Amalek",
    support: {
      moses: {
        action: "stood_on_hill_with_Aaron_and_Hur",
        role: "held_up_hands_with_staff"
      },
      dynamics: [
        "when_Moses_held_up_his_hand_Israel_prevailed",
        "when_he_lowered_his_hand_Amalek_prevailed"
      ],
      assistance: {
        problem: "Moses_hands_grew_weary",
        solution: [
          "they_took_stone_and_put_it_under_him_and_he_sat_on_it",
          "Aaron_and_Hur_held_up_his_hands_one_on_one_side_and_one_on_other",
          "his_hands_were_steady_until_going_down_of_sun"
        ]
      }
    },
    outcome: [
      "Joshua_overwhelmed_Amalek_and_his_people_with_sword"
    ]
  });

  lord.instructMoses({
    command: [
      "write_this_as_memorial_in_book",
      "recite_it_in_ears_of_Joshua"
    ],
    declaration: "I_will_utterly_blot_out_memory_of_Amalek_from_under_heaven"
  });

  moses.build({
    altar: {
      name: "Lord_Is_My_Banner",
      declaration: [
        "hand_upon_throne_of_Lord",
        "Lord_will_have_war_with_Amalek_from_generation_to_generation"
      ]
    }
  });
}
```
